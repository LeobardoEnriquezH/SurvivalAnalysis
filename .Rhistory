db1$Status<-as.factor(db1$Status)
density2<-db1 %>% ggplot(aes(x = Time)) + geom_density() + theme_bw()
grid.arrange(density1, density2, nrow = 1)
descdist(db$Time, discrete=FALSE, boot=500)
descdist(db1$Time, discrete=FALSE, boot=500)
fw <- fitdist(db$Time, "weibull")
fg <- fitdist(db$Time, "gamma")
fe <- fitdist(db$Time, "exp")
par(mfrow = c(2, 2))
plot.legend <- c("Weibull", "gamma", "expo")
denscomp(list(fw, fg, fe), legendtext = plot.legend)
qqcomp(list(fw, fg, fe), legendtext = plot.legend)
cdfcomp(list(fw, fg, fe), legendtext = plot.legend)
ppcomp(list(fw, fg, fe), legendtext = plot.legend)
denscomp(list(fw, fg), legendtext = c("Weibull", "gamma"))
fw <- fitdist(db1$Time, "weibull")
fg <- fitdist(db1$Time, "gamma")
fe <- fitdist(db1$Time, "exp")
par(mfrow = c(2, 2))
plot.legend <- c("Weibull", "gamma", "expo")
denscomp(list(fw, fg, fe), legendtext = plot.legend)
qqcomp(list(fw, fg, fe), legendtext = plot.legend)
cdfcomp(list(fw, fg, fe), legendtext = plot.legend)
ppcomp(list(fw, fg, fe), legendtext = plot.legend)
denscomp(list(fw, fg), legendtext = c("Weibull", "gamma"))
fit_Weibull<-fitdist(db$Time, "weibull")
fit_Weibull
fit_gamma<-fitdist(db$Time, "gamma")
fit_gamma
fit_Weibull<-fitdist(db1$Time, "weibull")
fit_Weibull
fit_gamma<-fitdist(db1$Time, "gamma")
fit_gamma
set.seed(340)
par(mfrow = c(1, 2))
distribuciones1<-db %>% ggplot(aes(x = Time, color = "datos")) + geom_density() +
geom_density(aes(x, color = "gamma"),
data = tibble(x = rgamma(500, shape = 31.6104024, rate = 0.1992656))) +
geom_density(aes(x, color = "weibull"),
data = tibble(x = rweibull(500, shape = 7.948114, scale = 168.720231))) + theme_bw()
distribuciones2<-db %>% ggplot(aes(x = Time, color = "datos")) + geom_density() +
geom_density(aes(x, color = "gamma"),
data = tibble(x = rgamma(500, shape = 60.3623749	, rate = 0.3721853	))) +
geom_density(aes(x, color = "weibull"),
data = tibble(x = rweibull(500, shape = 9.323776	, scale = 170.996408))) + theme_bw()
grid.arrange(distribuciones1, distribuciones2, nrow = 1)
db1_1<-db1%>%filter(Type==1)
fit_Weibull_1<-fitdist(db1_1$Time, "weibull")
fit_Weibull_1
db1_2<-db1%>%filter(Type==2)
fit_Weibull_2<-fitdist(db1_2$Time, "weibull")
fit_Weibull_2
db1_3<-db1%>%filter(Type==3)
fit_Weibull_3<-fitdist(db1_3$Time, "weibull")
fit_Weibull_3
db1_4<-db1%>%filter(Type==4)
fit_Weibull_4<-fitdist(db1_4$Time, "weibull")
fit_Weibull_4
set.seed(340)
db1 %>% ggplot(aes(x = Time, color = "datos")) + geom_density() +
geom_density(aes(x, color = "weibull1"),
data = tibble(x = rweibull(500, shape = 9.323827, scale = 171.181605))) +
geom_density(aes(x, color = "weibull2"),
data = tibble(x = rweibull(500, shape = 9.181701, scale = 170.791464))) +
geom_density(aes(x, color = "weibull3"),
data = tibble(x = rweibull(500, shape = 9.289101, scale = 170.799229))) +
geom_density(aes(x, color = "weibull4"),
data = tibble(x = rweibull(500, shape = 9.507079, scale = 171.213707))) +
theme_bw()
ajusteSurv <- survfit(Surv(db1$Time, db1$Status)~1)
typeof(ajusteSurv)
ajusteSurv$pstate[,1]
View(ajusteSurv)
#ajusteSurv$pstate[,1]
ajusteSurv$surv<-ajusteSurv$pstate[,1]
tibble(time = ajusteSurv$time, surv = ajusteSurv$surv) %>% ggplot(aes(x = time, y = surv)) + geom_step()
View(db1)
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(color = "goldenrod2") +
geom_step(color = "darkorchid3",data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(color = "cornflowerblue",data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(color = "deeppink2",data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv))
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(color = "goldenrod2") +
geom_step(color = "darkorchid3",data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(color = "cornflowerblue",data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(color = "deeppink2",data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) + theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(color = "goldenrod2") +
geom_step(color = "darkorchid3",data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv), how.legend=TRUE) +
geom_step(color = "cornflowerblue",data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(color = "deeppink2",data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) + theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(color = "goldenrod2") +
geom_step(color = "darkorchid3",data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv), Show.legend=TRUE) +
geom_step(color = "cornflowerblue",data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(color = "deeppink2",data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) + theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(color = "1") +
geom_step(color = "2",data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(color = "3",data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(color = "4",data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(color = "1") +
geom_step(color = "2",data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(color = "3",data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(color = "4",data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(es(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(aes(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
knitr::opts_chunk$set(
#echo = FALSE, #Podemos evitar que se muestre el código en general
fig.pos = 'H', #Posicionamos todas las gráficas en el lugar donde se calculan
fig.align = 'center', #Posicionamos todas las gráficas en el lugar en el centro del documento
message = FALSE, #Evitamos los mensajes
warning = FALSE, #Evitamos los warnings
comment = NA #Evitamos los comentarios
)
library(tidyselect)
library(survival)
library(survminer)
library(dplyr)
library(ggplot2)
library(gridExtra)
library("MASS")
library("fitdistrplus")
library(flexsurv)
library(ranger)
library(ggfortify)
db<-read.csv("data09.csv")
db$Type<-as.factor(db$Type)
db$Status<-as.factor(db$Status)
summary(db)
("NA's:")
db$Time %>% is.na() %>% sum()
q<-db$Time %>% quantile(.05)
par(mfrow = c(1, 2))
boxplot1<-db%>% ggplot(aes(x = Time)) + geom_boxplot() + theme_bw()
boxplot2<-db%>%filter(Time>q ) %>% ggplot(aes(x = Time)) + geom_boxplot()+ theme_bw()
grid.arrange(boxplot1, boxplot2, nrow = 1)
par(mfrow = c(1, 2))
density1<-db %>% ggplot(aes(x = Time)) + geom_density() + theme_bw()
db1 <- db %>% filter(Time>=110.7846)
db1$Type<-as.factor(db1$Type)
db1$Status<-as.factor(db1$Status)
density2<-db1 %>% ggplot(aes(x = Time)) + geom_density() + theme_bw()
grid.arrange(density1, density2, nrow = 1)
descdist(db$Time, discrete=FALSE, boot=500)
descdist(db1$Time, discrete=FALSE, boot=500)
fw <- fitdist(db$Time, "weibull")
fg <- fitdist(db$Time, "gamma")
fe <- fitdist(db$Time, "exp")
par(mfrow = c(2, 2))
plot.legend <- c("Weibull", "gamma", "expo")
denscomp(list(fw, fg, fe), legendtext = plot.legend)
qqcomp(list(fw, fg, fe), legendtext = plot.legend)
cdfcomp(list(fw, fg, fe), legendtext = plot.legend)
ppcomp(list(fw, fg, fe), legendtext = plot.legend)
denscomp(list(fw, fg), legendtext = c("Weibull", "gamma"))
fw <- fitdist(db1$Time, "weibull")
fg <- fitdist(db1$Time, "gamma")
fe <- fitdist(db1$Time, "exp")
par(mfrow = c(2, 2))
plot.legend <- c("Weibull", "gamma", "expo")
denscomp(list(fw, fg, fe), legendtext = plot.legend)
qqcomp(list(fw, fg, fe), legendtext = plot.legend)
cdfcomp(list(fw, fg, fe), legendtext = plot.legend)
ppcomp(list(fw, fg, fe), legendtext = plot.legend)
denscomp(list(fw, fg), legendtext = c("Weibull", "gamma"))
fit_Weibull<-fitdist(db$Time, "weibull")
fit_Weibull
fit_gamma<-fitdist(db$Time, "gamma")
fit_gamma
fit_Weibull<-fitdist(db1$Time, "weibull")
fit_Weibull
fit_gamma<-fitdist(db1$Time, "gamma")
fit_gamma
set.seed(340)
par(mfrow = c(1, 2))
distribuciones1<-db %>% ggplot(aes(x = Time, color = "datos")) + geom_density() +
geom_density(aes(x, color = "gamma"),
data = tibble(x = rgamma(500, shape = 31.6104024, rate = 0.1992656))) +
geom_density(aes(x, color = "weibull"),
data = tibble(x = rweibull(500, shape = 7.948114, scale = 168.720231))) + theme_bw()
distribuciones2<-db %>% ggplot(aes(x = Time, color = "datos")) + geom_density() +
geom_density(aes(x, color = "gamma"),
data = tibble(x = rgamma(500, shape = 60.3623749	, rate = 0.3721853	))) +
geom_density(aes(x, color = "weibull"),
data = tibble(x = rweibull(500, shape = 9.323776	, scale = 170.996408))) + theme_bw()
grid.arrange(distribuciones1, distribuciones2, nrow = 1)
db1_1<-db1%>%filter(Type==1)
fit_Weibull_1<-fitdist(db1_1$Time, "weibull")
fit_Weibull_1
db1_2<-db1%>%filter(Type==2)
fit_Weibull_2<-fitdist(db1_2$Time, "weibull")
fit_Weibull_2
db1_3<-db1%>%filter(Type==3)
fit_Weibull_3<-fitdist(db1_3$Time, "weibull")
fit_Weibull_3
db1_4<-db1%>%filter(Type==4)
fit_Weibull_4<-fitdist(db1_4$Time, "weibull")
fit_Weibull_4
set.seed(340)
db1 %>% ggplot(aes(x = Time, color = "datos")) + geom_density() +
geom_density(aes(x, color = "weibull1"),
data = tibble(x = rweibull(500, shape = 9.323827, scale = 171.181605))) +
geom_density(aes(x, color = "weibull2"),
data = tibble(x = rweibull(500, shape = 9.181701, scale = 170.791464))) +
geom_density(aes(x, color = "weibull3"),
data = tibble(x = rweibull(500, shape = 9.289101, scale = 170.799229))) +
geom_density(aes(x, color = "weibull4"),
data = tibble(x = rweibull(500, shape = 9.507079, scale = 171.213707))) +
theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(aes(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
ajusteSurv_2$surv
max(ajusteSurv_4$surv - ajusteSurv_1$surv)
min(ajusteSurv_4$surv - ajusteSurv_1$surv)
max(ajusteSurv_4$time - ajusteSurv_1$time)
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
dist14<-ajusteSurv_4$time - ajusteSurv_1$time
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(aes(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
max(dist14)
ajusteSurv_2$time - ajusteSurv_1$time
max(ajusteSurv_2$time - ajusteSurv_1$time)
dist14
max(dist14)
print(paste("highest index is : ",which.max(dist14)))
ajusteSurv_1
tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tab1<-tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(aes(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tab1<-tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv)
tab4<-tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(aes(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
View(tab1)
View(tab4)
View(tab1)
View(tab4)
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tab1<-tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv)
tab4<-tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)
tab<-tab4$time-tab4$time
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(aes(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tab1<-tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv)
tab4<-tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)
tab<-cbind(tab,tab4)
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(aes(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tab1<-tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv)
tab4<-tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)
tab<-cbind(tab1,tab4)
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(aes(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
View(tab)
db1_1 <- db %>% filter(Type == 1)
db1_2 <- db %>% filter(Type == 2)
db1_3 <- db %>% filter(Type == 3)
db1_4 <- db %>% filter(Type == 4)
ajusteSurv_1 <- survfit(Surv(db1_1$Time, db1_1$Status)~1)
ajusteSurv_1$surv<-ajusteSurv_1$pstate[,1]
ajusteSurv_2 <- survfit(Surv(db1_2$Time, db1_2$Status)~1)
ajusteSurv_2$surv<-ajusteSurv_2$pstate[,1]
ajusteSurv_3 <- survfit(Surv(db1_3$Time, db1_3$Status)~1)
ajusteSurv_3$surv<-ajusteSurv_3$pstate[,1]
ajusteSurv_4 <- survfit(Surv(db1_4$Time, db1_4$Status)~1)
ajusteSurv_4$surv<-ajusteSurv_4$pstate[,1]
tab1<-tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv)
tab4<-tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)
tab<-cbind(tab1,tab4)
names(tab)<-c("time1", "surv1", "time4", "surv4")
tab$dif<-tab$time4-tab$time1
tibble(time = ajusteSurv_1$time, surv = ajusteSurv_1$surv) %>%
ggplot(aes(x = time, y = surv, fill = "Type1")) + geom_step(aes(color = "1")) +
geom_step(aes(color = "2"),data = tibble(time = ajusteSurv_2$time, surv = ajusteSurv_2$surv)) +
geom_step(aes(color = "3"),data = tibble(time = ajusteSurv_3$time, surv = ajusteSurv_3$surv)) +
geom_step(aes(color = "4"),data = tibble(time = ajusteSurv_4$time, surv = ajusteSurv_4$surv)) +
scale_color_manual(labels = c("1" = "Type1", "2" = "Type2", "3" = "Type3", "4" = "Type4"),
values = c("1" = "goldenrod2", "2" = "darkorchid3", "3" = "cornflowerblue", "4" = "deeppink2")) + theme_bw()
View(tab)
